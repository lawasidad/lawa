<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ÙÛ†Ø±Ù…ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ - Ú©Û†Ù…Ù¾Ø§Ù†ÛŒØ§ÛŒ Ù‚Û•Ù†Ø¯ÛŒÙ„</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f4f8;
    padding: 15px;
  }
  h2 {
    text-align: center;
    margin-bottom: 20px;
    color: #0b6623;
  }
  .product-list {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    margin-bottom: 25px;
  }
  .product {
    width: 140px;
    border: 2px solid #aaa;
    border-radius: 8px;
    background: #fff;
    text-align: center;
    padding: 10px 8px;
    cursor: pointer;
    user-select: none;
    transition: all 0.3s ease;
    position: relative;
  }
  .product.selected {
    border-color: #28a745;
    background: #d4edda;
  }
  .product img {
    width: 120px;
    height: 120px;
    object-fit: contain;
    margin-bottom: 10px;
  }
  .quantity-controls {
    display: flex;
    justify-content: center;
    gap: 6px;
    margin-top: 6px;
  }
  .quantity-controls button {
    width: 28px;
    height: 28px;
    background-color: #28a745;
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
    user-select: none;
  }
  .quantity-controls span {
    min-width: 22px;
    font-weight: bold;
    text-align: center;
    display: inline-block;
    user-select: none;
  }
  form {
    max-width: 400px;
    margin: 0 auto;
    background: white;
    padding: 15px 20px;
    border-radius: 12px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  label {
    font-weight: bold;
    margin-top: 12px;
    display: block;
  }
  input, button {
    width: 100%;
    padding: 10px 12px;
    margin-top: 6px;
    border-radius: 8px;
    border: 1.5px solid #ccc;
    font-size: 16px;
  }
  button {
    background-color: #28a745;
    color: white;
    font-weight: bold;
    margin-top: 20px;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #1e7e34;
  }
  #totalAmount {
    font-weight: bold;
    font-size: 18px;
    color: #28a745;
    margin-top: 15px;
    text-align: center;
  }
  #successMessage {
    margin-top: 15px;
    font-weight: bold;
    color: #155724;
    text-align: center;
    display: none;
  }
</style>
</head>
<body>

<h2>ÙÛ†Ø±Ù…ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ú©Ø§ÚµØ§</h2>

<div class="product-list" id="productList"></div>

<form id="orderForm">
  <label for="customerName">Ù†Ø§ÙˆÛŒ Ú©Ø±ÛŒØ§Ø±</label>
  <input type="text" id="customerName" placeholder="Ù†Ø§ÙˆÛŒ Ø®Û†Øª Ø¨Ù†ÙˆÙˆØ³Û•" required />

  <label for="mobile">Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„</label>
  <input type="tel" id="mobile" placeholder="07XX XXX XXX" required pattern="07[0-9]{8,9}" />

  <label for="address">Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†</label>
  <input type="text" id="address" placeholder="Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†Øª Ø¨Ù†ÙˆÙˆØ³Û•" required />

  <label for="gps">GPS (Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Û•Ø±Ú©Û•ÙˆØªÙ†)</label>
  <input type="text" id="gps" readonly placeholder="Ú©Û†Ø¢Ø±Ø¯ÛŒÙ†Ø§ØªÛ•Ú©Ø§Ù† Ø¦Û•Ù†Ø¬Ø§Ù… Ø¨Ø¯Ø±ÛÙ†" />

  <label for="note">ØªÛØ¨ÛŒÙ†ÛŒ (Ù‡Û•Ù„Ø¨Ú˜Ø§Ø±Ø¯Ù†)</label>
  <input type="text" id="note" placeholder="ØªÛØ¨ÛŒÙ†ÛŒÛ•Ú©Ø§Ù† Ø¨Ù†ÙˆÙˆØ³Û•" />

  <div id="totalAmount">Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ: Ù  Ø¯ÛŒÙ†Ø§Ø±</div>

  <button type="submit">âœ… Ù†Ø§Ø±Ø¯Ù†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ</button>

  <p id="successMessage">âœ… Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ù†ÛØ±Ø¯Ø±Ø§ Ø¨Û•Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒ!</p>
</form>

<script>
  // Ù†Ù…ÙˆÙˆÙ†Û• Ú©Ø§ÚµØ§Ú©Ø§Ù† Ø¨Û† Ù¾ÛŒØ´Ø§Ù†Ø¯Ø§Ù†ÛŒ
  const products = [
    { id: 1, name: "Ø´Û•Ú©Ø±", price: 2000, image: "https://via.placeholder.com/120?text=Ø´Û•Ú©Ø±" },
    { id: 2, name: "Ú©Ø§ÙÛŒ", price: 5000, image: "https://via.placeholder.com/120?text=Ú©Ø§ÙÛŒ" },
    { id: 3, name: "Ú©Ø§Ú©Ø§Ø¦Ùˆ", price: 3000, image: "https://via.placeholder.com/120?text=Ú©Ø§Ú©Ø§Ø¦Ùˆ" }
  ];

  // Ø´ÛŒÛŒ Ù‡Û•Ù„Ø¨Ú˜Ø§Ø±Ø¯Ù†Û•Ú©Ø§Ù† Ø¨Û† Ù‡Û•Ø± Ú©Ø§ÚµØ§
  let selected = {};

  const productList = document.getElementById("productList");
  const totalAmountEl = document.getElementById("totalAmount");
  const successMessage = document.getElementById("successMessage");

  function renderProducts() {
    productList.innerHTML = "";
    let total = 0;

    products.forEach(p => {
      const qty = selected[p.id] || 0;
      const isSelected = qty > 0;

      const div = document.createElement("div");
      div.classList.add("product");
      if (isSelected) div.classList.add("selected");

      div.innerHTML = `
        <img src="${p.image}" alt="${p.name}" />
        <div><strong>${p.name}</strong></div>
        <div>${p.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
      `;

      // Ù†ÛŒØ´Ø§Ù†Ø¯Ø§Ù†ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÚ©Ø§Ù†ÛŒ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù† Ùˆ Ú©Û•Ù…Ú©Ø±Ø¯Ù†
      if (isSelected) {
        const controls = document.createElement("div");
        controls.classList.add("quantity-controls");

        const btnMinus = document.createElement("button");
        btnMinus.textContent = "-";
        btnMinus.onclick = (e) => {
          e.stopPropagation();
          if (selected[p.id] > 1) {
            selected[p.id]--;
          } else {
            delete selected[p.id];
          }
          updateUI();
        };

        const qtySpan = document.createElement("span");
        qtySpan.textContent = qty;

        const btnPlus = document.createElement("button");
        btnPlus.textContent = "+";
        btnPlus.onclick = (e) => {
          e.stopPropagation();
          selected[p.id] = (selected[p.id] || 0) + 1;
          updateUI();
        };

        controls.appendChild(btnMinus);
        controls.appendChild(qtySpan);
        controls.appendChild(btnPlus);

        div.appendChild(controls);

        total += p.price * qty;
      }

      div.onclick = () => {
        if (isSelected) {
          delete selected[p.id];
        } else {
          selected[p.id] = 1;
        }
        updateUI();
      };

      productList.appendChild(div);
    });

    totalAmountEl.textContent = `Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ: ${total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±`;
  }

  function updateUI() {
    renderProducts();
  }

  // Ø¨Û•Ø¯Û•Ø³ØªÙ‡ÛÙ†Ø§Ù†ÛŒ GPS Ø¨Û•Ø´ÛÙˆÛ•ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±
  function fetchGPS() {
    const gpsInput = document.getElementById("gps");
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const coords = `${pos.coords.latitude.toFixed(5)}, ${pos.coords.longitude.toFixed(5)}`;
          gpsInput.value = coords;
        },
        (err) => {
          gpsInput.value = "Ù†Ø§ØªÙˆØ§Ù†Ø±Ø§ÛŒÛ• GPS Ø¨Ú¯Û•Ú•ÛÙ†Ø¯Ø±ÛØª";
          console.warn("Error getting GPS:", err.message);
        }
      );
    } else {
      gpsInput.value = "Ø¨Û•Ø±Ø¯Û•Ø³Øª Ù†ÛŒÛ• Ù„Û• Ú©Û•Ø±ÙˆÛÙ„ÛØ´Ù†";
    }
  }

  // ÙˆÛ•Ø±Ø¯Û•Ú¯Ø±ØªÙ†ÛŒ ÙÛ†Ø±Ù…ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ
  document.getElementById("orderForm").addEventListener("submit", e => {
    e.preventDefault();
    successMessage.style.display = "none";

    const name = document.getElementById("customerName").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const address = document.getElementById("address").value.trim();
    const gps = document.getElementById("gps").value.trim();
    const note = document.getElementById("note").value.trim();

    if (!name || !mobile || !address) {
      alert("ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ø± Ø¨Ú©Û•ÙˆÛ•");
      return;
    }

    if (Object.keys(selected).length === 0) {
      alert("ØªÚ©Ø§ÛŒÛ• Ú©Ø§ÚµØ§ÛŒÛ•Ú© Ù‡Û•Ù„Ø¨Ú˜ÛØ±Û•");
      return;
    }

    // Ú¯Ø±ØªÙ†ÛŒ Ú©Ø§ÚµØ§Ú©Ø§Ù†ÛŒ Ù‡Û•Ù„Ø¨Ú˜ÛØ±Ø¯Ø±Ø§Ùˆ
    const orderedProducts = products
      .filter(p => selected[p.id])
      .map(p => ({
        name: p.name,
        quantity: selected[p.id],
        price: p.price,
        totalPrice: p.price * selected[p.id]
      }));

    const total = orderedProducts.reduce((acc, p) => acc + p.totalPrice, 0);

    // Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†ÛŒ Ù¾Û•ÛŒØ§Ù…Û•Ú©Û• Ø¨Û† ÙˆØ§ØªØ³Ø§Ù¾
    let whatsappMessage = `ğŸ”” *ÙˆÛ•Ø³ÚµÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ*\n\n`;
    whatsappMessage += `*Ù†Ø§ÙˆÛŒ Ú©Ø±ÛŒØ§Ø±:* ${name}\n`;
    whatsappMessage += `*Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„:* ${mobile}\n`;
    whatsappMessage += `*Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†:* ${address}\n`;
    whatsappMessage += `*GPS:* ${gps}\n`;
    if(note) whatsappMessage += `*ØªÛØ¨ÛŒÙ†ÛŒ:* ${note}\n`;
    whatsappMessage += `\n*Ú©Ø§ÚµØ§Ú©Ø§Ù†:* \n`;

    orderedProducts.forEach(p => {
      whatsappMessage += `- ${p.name} Ã— ${p.quantity} = ${p.totalPrice.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±\n`;
    });

    whatsappMessage += `\n*Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:* ${total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±\n`;
    whatsappMessage += `\n*Ú©Ø§ØªÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ:* ${new Date().toLocaleString()}`;

    // Ø¨Ú˜Ù…Ø§Ø±Û• ÙˆØ§ØªØ³Ø§Ù¾ Ø¨Û Ù¾ÛØ´Ú©Û•Ø´ (+964...) Ø¨Û• Ø´ÛÙˆÛ•ÛŒ Ù†Ø±Ù…Ø§Ù„
    const whatsappNumber = "9647502020061";

    // Ø¦Û•Ù… Ù„ÛŒÙ†Ú©ÛŒ ÙˆØ§ØªØ³Ø§Ù¾Û• Ø¨Û•Ø±Û•Ùˆ Ù†ÙˆÙˆØ³ÛŒÙ†ÛŒ Ù¾Û•ÛŒØ§Ù…Û•Ú©Û• Ø¯Û•Ú†ÛØª
    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;

    // Ú©Ø±ØªÛ• Ú©Ø±Ø¯Ù† Ø¨Û† Ú©Ø±ØªÛ•Ú©Ø±Ø¯Ù†ÛŒ ÙˆØ§ØªØ³Ø§Ù¾ Ù„Û• Ø¨Ú•Ø§ÙˆØ²Û•Ø±
    window.open(whatsappURL, "_blank");

    // Ù¾Ø§Ú©Ú©Ø±Ø¯Ù†ÛŒ Ù‡Û•Ù„Ø¨Ú˜Ø§Ø±Ø¯Ù† Ùˆ ÙÛ†Ø±Ù…Û•Ú©Û• Ø¨Û† Ù†Ø§Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú©ÛŒ Ù†ÙˆÛ
    selected = {};
    updateUI();
    e.target.reset();

    successMessage.style.display = "block";
  });

  // Ø¯Ø§Ù†Ø§Ù†ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ú©Û†Ø¯Û•Ú©Ø§Ù† Ù„Û• Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù¾Û•Ú•Û•
  window.onload = () => {
    renderProducts();
    fetchGPS();
  };
</script>

</body>
</html>
