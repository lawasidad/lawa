<!DOCTYPE html>
<html lang="ku">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>داشبۆردی داواکاری و وەسڵ</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f9fafd;
    margin: 0; padding: 0;
    color: #222;
  }
  header {
    background: #0d6efd;
    color: white;
    padding: 1rem 0;
    text-align: center;
    font-size: 1.8rem;
    font-weight: bold;
  }
  nav {
    display: flex;
    justify-content: center;
    gap: 2rem;
    background: #fff;
    padding: 1rem 0;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    position: sticky;
    top: 0;
    z-index: 10;
  }
  nav button {
    border: none;
    background: none;
    font-size: 1.1rem;
    color: #0d6efd;
    cursor: pointer;
    padding: 0.5rem 1.5rem;
    border-radius: 6px;
    transition: background-color 0.3s;
  }
  nav button.active, nav button:hover {
    background: #0d6efd;
    color: white;
  }
  main {
    max-width: 900px;
    margin: 2rem auto;
    padding: 0 1rem;
  }
  /* فۆڕم */
  form {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgb(0 0 0 / 0.1);
    max-width: 480px;
    margin: 1rem auto;
  }
  form label {
    display: block;
    margin-bottom: 0.3rem;
    font-weight: 600;
  }
  form input, form textarea {
    width: 100%;
    padding: 0.5rem;
    margin-bottom: 1rem;
    border-radius: 5px;
    border: 1px solid #ced4da;
    font-size: 1rem;
    resize: vertical;
  }
  form button {
    background: #0d6efd;
    border: none;
    color: white;
    padding: 0.7rem 1.2rem;
    font-size: 1.1rem;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
    transition: background-color 0.3s ease;
  }
  form button:hover {
    background: #084bcc;
  }
  /* جەنجالێکی سادە بۆ نیشاندانی لینک */
  #shareLinkBox {
    background: #e9ecef;
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    font-size: 1.1rem;
    user-select: all;
    margin-bottom: 2rem;
  }
  /* جدول وەسڵەکان */
  #receiptsSection {
    display: none;
    background: white;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgb(0 0 0 / 0.1);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
  }
  th, td {
    border: 1px solid #dee2e6;
    padding: 0.5rem;
    text-align: center;
  }
  th {
    background: #0d6efd;
    color: white;
  }
  #summary {
    font-weight: bold;
    font-size: 1.1rem;
    text-align: right;
    color: #0d6efd;
  }
</style>
</head>
<body>

<header>داشبۆردی داواکاری و وەسڵ</header>

<nav>
  <button id="btnOrderForm" class="active">فۆڕمی داواکاری و لینک</button>
  <button id="btnReceipts">وەسڵەکان</button>
</nav>

<main>

  <!-- بەش لینک و فۆڕم داواکاری -->
  <section id="orderSection">
    <div id="shareLinkBox">
      <strong>لینکی داواکاری (بە کڕیارەکان بنێرە):</strong><br />
      <code id="shareLink"></code>
    </div>

    <form id="orderForm">
      <h3>فۆڕمی داواکاری</h3>
      <label for="customerName">ناوی کڕیار</label>
      <input type="text" id="customerName" required placeholder="ناوی کڕیار بنوسە" />
      
      <label for="productName">ناوی کاڵا</label>
      <input type="text" id="productName" required placeholder="ناوی کاڵا بنوسە" />
      
      <label for="quantity">ژمارە</label>
      <input type="number" id="quantity" min="1" value="1" required />
      
      <label for="notes">تێبینی (بەختیار)</label>
      <textarea id="notes" rows="3" placeholder="هەر تێبینیەکت بنوسە"></textarea>
      
      <button type="submit">داواکردن</button>
      <p id="orderSuccess" style="color:green; display:none; margin-top: 10px;">داواکاری بە سەرکەوتوویی نێردرا!</p>
    </form>
  </section>

  <!-- بەش وەسڵەکان -->
  <section id="receiptsSection">
    <h3>وەسڵەکان</h3>
    <table>
      <thead>
        <tr>
          <th>ناوی کڕیار</th>
          <th>کاڵا</th>
          <th>ژمارە</th>
          <th>تێبینی</th>
        </tr>
      </thead>
      <tbody id="receiptsTableBody"></tbody>
    </table>
    <div id="summary"></div>
  </section>

</main>

<script>
  // دابنێ لینکی داواکاری بۆ کڕیار
  function generateShareLink() {
    // ئەم پەڕەیەیە (ئەمە کۆدی سادەیە، ئەگەر لە هاوڵاتی وێب بەکارهێنیت ئەم لینکە نوێ دەبێت)
    const baseUrl = window.location.origin + window.location.pathname;
    return baseUrl + "?orderForm=1";
  }

  // نیشاندانی لینکی داواکاری
  const shareLinkEl = document.getElementById("shareLink");
  shareLinkEl.textContent = generateShareLink();

  // وەسڵەکان لە localStorage هەڵگەڕانەوە یان دروستکردن
  let receipts = JSON.parse(localStorage.getItem("receipts")) || [];

  // نیشاندانی وەسڵەکان
  const receiptsTableBody = document.getElementById("receiptsTableBody");
  const summaryDiv = document.getElementById("summary");

  function renderReceipts() {
    receiptsTableBody.innerHTML = "";
    let totalQuantity = 0;
    receipts.forEach(({ customerName, productName, quantity, notes }, idx) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${customerName}</td>
        <td>${productName}</td>
        <td>${quantity}</td>
        <td>${notes || ""}</td>
      `;
      receiptsTableBody.appendChild(tr);
      totalQuantity += Number(quantity);
    });
    summaryDiv.textContent = `کۆی گشتی ژمارە: ${totalQuantity}`;
  }

  renderReceipts();

  // فۆڕم و داواکاری ناردن
  const orderForm = document.getElementById("orderForm");
  const orderSuccess = document.getElementById("orderSuccess");

  orderForm.addEventListener("submit", e => {
    e.preventDefault();
    const customerName = document.getElementById("customerName").value.trim();
    const productName = document.getElementById("productName").value.trim();
    const quantity = document.getElementById("quantity").value.trim();
    const notes = document.getElementById("notes").value.trim();

    if (!customerName || !productName || !quantity) return alert("تکایە خانەکان پڕ بکەوە.");

    // زیادکردنی وەسڵ بە لیست و localStorage
    receipts.push({ customerName, productName, quantity, notes });
    localStorage.setItem("receipts", JSON.stringify(receipts));

    orderSuccess.style.display = "block";

    // پاککردنی فۆڕم
    orderForm.reset();

    renderReceipts();
  });

  // بەرزکردنی بەشەکان بە کلیک لە ناو ناڤ
  const btnOrderForm = document.getElementById("btnOrderForm");
  const btnReceipts = document.getElementById("btnReceipts");
  const orderSection = document.getElementById("orderSection");
  const receiptsSection = document.getElementById("receiptsSection");

  btnOrderForm.addEventListener("click", () => {
    btnOrderForm.classList.add("active");
    btnReceipts.classList.remove("active");
    orderSection.style.display = "block";
    receiptsSection.style.display = "none";
  });

  btnReceipts.addEventListener("click", () => {
    btnReceipts.classList.add("active");
    btnOrderForm.classList.remove("active");
    receiptsSection.style.display = "block";
    orderSection.style.display = "none";
  });

  // ئەگەر بەتایبەتی لینکی ?orderForm=1 هەبێت بۆ بەکارهێنەر، بەشەکەی فۆڕمە داواکاری نیشان بدرێت بەردەست
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get("orderForm") === "1") {
    btnOrderForm.click();
  } else {
    btnReceipts.click();
  }
</script>

</body>
</html>
