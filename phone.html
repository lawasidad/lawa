<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8">
  <title>Ù†Ø§Ø±Ø¯Ù†ÛŒ Ù¾Û•ÛŒØ§Ù… Ø¨Û† ØªÛŒÙ„Û•Ú¯Ø±Ø§Ù…</title>
</head>
<body>
  <h2>Ù†Ø§Ø±Ø¯Ù†ÛŒ Ù¾Û•ÛŒØ§Ù… Ø¨Û† ØªÛŒÙ„Û•Ú¯Ø±Ø§Ù…</h2>
  <textarea id="message" placeholder="Ù¾Û•ÛŒØ§Ù… Ø¨Ù†ÙˆØ³Û•">Ø³Ù„Ø§Ùˆ</textarea>
  <br>
  <button onclick="sendMessages()">Ù†Ø§Ø±Ø¯Ù†</button>
  <div id="result"></div>

  <script>
    async function sendMessages() {
      const resultDiv = document.getElementById("result");
      resultDiv.innerText = "ğŸš€ Ù†Ø§Ø±Ø¯Ù† Ø¯Û•Ø³Øª Ù¾ÛÚ©Ø±Ø¯...";

      try {
        const response = await fetch("phones.json");
        const phones = await response.json();

        if (!Array.isArray(phones)) {
          resultDiv.innerText = "âš ï¸ phones.json Ù¾ÛÙˆÛŒØ³ØªÛ• Ù„ÛŒØ³Øª Ø¨ÛØª.";
          return;
        }

        const message = document.getElementById("message").value;
        const botToken = "ØªÙˆÚ©Ù†-ÛŒ-ØªÛ•Ù„Û•Ú¯Ø±Ø§Ù…-Ø¨Û†Øª";
        const sendPromises = phones.map(async (entry) => {
          const phone = entry.phone;
          const chat_id = phone; // ÛŒØ§ Ù†Ø§ÙˆÛ•Ú•Û†Ú©ÛŒ chat_id Ø¨Ú¯Ø±Û• Ù„Û• entry

          return fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              chat_id: chat_id,
              text: message
            })
          });
        });

        await Promise.all(sendPromises);
        resultDiv.innerText = "âœ… Ù‡Û•Ù…ÙˆÙˆ Ù¾Û•ÛŒØ§Ù…Û•Ú©Ø§Ù† Ù†ÛØ±Ø¯Ø±Ø§Ù†.";

      } catch (error) {
        console.error(error);
        resultDiv.innerText = "âŒ Ú©ÛØ´Û•ÛŒÛ•Ú© Ú•ÙˆÙˆÛŒØ¯Ø§: " + error.message;
      }
    }
  </script>
</body>
</html>
