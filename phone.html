<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8" />
  <title>Phone List</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    input[type="text"] {
      width: 70%;
      padding: 10px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      margin-left: 10px;
      background: green;
      color: white;
      border: none;
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background: #f2f2f2;
    }
  </style>
</head>
<body>
  <h2>لیستی ژمارەکان</h2>

  <input type="text" id="messageInput" placeholder="نامەکەت لێرە بنوسە..." />
  <button onclick="sendSelectedMessages()">ناردنی پەیام</button>

  <table>
    <thead>
      <tr>
        <th><input type="checkbox" id="selectAll" onchange="toggleAll(this)" /></th>
        <th>ناو</th>
        <th>ژمارە</th>
        <th>ناردن</th>
      </tr>
    </thead>
    <tbody id="phoneList"></tbody>
  </table>

  <script>
    // داهێنانی داتاکان لە phones.json
    fetch("phones.json")
      .then((res) => res.json())
      .then((data) => {
        const tbody = document.getElementById("phoneList");
        data.forEach((item, index) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td><input type="checkbox" class="select" value="${item.mobile}" /></td>
            <td>${item.name}</td>
            <td>${item.mobile}</td>
            <td><button onclick="sendMessage('${item.mobile}')">ناردن</button></td>
          `;
          tbody.appendChild(tr);
        });
      });

    // ناردنی نامە بە واتساپ بۆ ژمارە تاک
    function sendMessage(phone) {
      const message = document.getElementById("messageInput").value;
      if (!message) {
        alert("تکایە نامەکە بنوسە");
        return;
      }
      const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url, "_blank");
    }

    // ناردنی بۆ هەموو ژمارە سلێکتکراوەکان
    function sendSelectedMessages() {
      const message = document.getElementById("messageInput").value;
      if (!message) {
        alert("تکایە نامەکە بنوسە");
        return;
      }
      const selected = document.querySelectorAll(".select:checked");
      if (selected.length === 0) {
        alert("تکایە ژمارەیەک هەلبژێرە");
        return;
      }
      selected.forEach((checkbox) => {
        const phone = checkbox.value;
        const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
        window.open(url, "_blank");
      });
    }

    // فەرمی سلێکت/دیسلێکت کردنی هەموو
    function toggleAll(source) {
      const checkboxes = document.querySelectorAll(".select");
      checkboxes.forEach((cb) => cb.checked = source.checked);
    }
  </script>
</body>
</html>
