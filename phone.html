<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8" />
  <title>Whatsapp Bulk Sender</title>
  <style>
    body { font-family: Arial; direction: rtl; text-align: right; padding: 20px; }
    #send { margin: 10px 0; }
    input[type="checkbox"] { transform: scale(1.3); margin-left: 5px; }
  </style>
</head>
<body>

<h3>📩 ناردنی پەیام بۆ ژمارەکان بە وەتسئاپ</h3>

<textarea id="message" rows="4" cols="50" placeholder="پەیامەکەت لێرە بنوسە..."></textarea><br>
<button id="send">📤 ناردن بە وەتس‌ئاپ</button>
<br><br>

<label><input type="checkbox" id="selectAll"> هەموو ژمارەکان دیاری بکە</label>
<ul id="phoneList"></ul>

<script>
fetch('phones.json')
  .then(response => response.json())
  .then(data => {
    const list = document.getElementById('phoneList');
    data.forEach((item, index) => {
      const li = document.createElement('li');
      li.innerHTML = `<input type="checkbox" class="phone" value="${item.phone}"> ${item.name} - ${item.phone}`;
      list.appendChild(li);
    });

    document.getElementById('selectAll').addEventListener('change', function () {
      document.querySelectorAll('.phone').forEach(cb => cb.checked = this.checked);
    });

    document.getElementById('send').addEventListener('click', () => {
      const message = encodeURIComponent(document.getElementById('message').value.trim());
      const selectedPhones = Array.from(document.querySelectorAll('.phone:checked')).map(cb => cb.value);
      if (!message || selectedPhones.length === 0) return alert("تکایە پەیام بنوسە و ژمارە دیاری بکە");

      selectedPhones.forEach(phone => {
        const link = `https://wa.me/${phone}?text=${message}`;
        window.open(link, '_blank');
      });
    });
  })
  .catch(err => {
    console.error("هەڵە لە وەرگرتنی phones.json:", err);
    alert("نەتوانرا پەیوەندیکردن بە فایلەکە. دڵنیابە لەوەی بە ڕێی سێرڤەرە.");
  });
</script>

</body>
</html>
