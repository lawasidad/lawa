<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8">
  <title>Phone List</title>
  <style>
    body { font-family: sans-serif; padding: 10px; background: #f2f2f2; }
    h2 { text-align: center; }
    table { width: 100%; border-collapse: collapse; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #eee; }
    textarea { width: 100%; height: 80px; margin: 10px 0; }
    button { padding: 10px 20px; background: green; color: white; border: none; cursor: pointer; }
    button:hover { background: darkgreen; }
  </style>
</head>
<body>

<h2>لیستی ژمارەکان</h2>

<label><input type="checkbox" id="selectAll"> هەمووی دیاری بکە</label>
<br>
<textarea id="message" placeholder="نامەکە لێرە بنووسە..."></textarea>
<button onclick="sendMessage()">ناردنی پەیام بۆ وەتس‌ئاپ</button>

<table id="phoneTable">
  <thead>
    <tr>
      <th>دیاری بکە</th>
      <th>ناو</th>
      <th>ژمارە</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
fetch('phones.json')
  .then(res => res.json())
  .then(data => {
    const tbody = document.querySelector("#phoneTable tbody");
    data.forEach((item, index) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="checkbox" class="phoneCheck" value="${item.phone}"></td>
        <td>${item.name}</td>
        <td>${item.phone}</td>
      `;
      tbody.appendChild(tr);
    });
  });

// هەموو checkbox ـەکان دیاری بکە
document.getElementById("selectAll").addEventListener("change", function () {
  const allChecks = document.querySelectorAll(".phoneCheck");
  allChecks.forEach(ch => ch.checked = this.checked);
});

// ناردنی واتس‌ئاپ
function sendMessage() {
  const message = document.getElementById("message").value.trim();
  if (!message) {
    alert("تکایە نامەکە بنووسە.");
    return;
  }

  const selectedPhones = Array.from(document.querySelectorAll(".phoneCheck:checked"))
    .map(input => input.value);

  if (selectedPhones.length === 0) {
    alert("تکایە ژمارە دیاری بکە.");
    return;
  }

  selectedPhones.forEach(phone => {
    const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
    window.open(url, "_blank");
  });
}
</script>

</body>
</html>
