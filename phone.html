<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8">
  <title>ناردنی پەیام بۆ تیلەگرام</title>
</head>
<body>
  <h2>ناردنی پەیام بۆ تیلەگرام</h2>
  <textarea id="message" placeholder="پەیام بنوسە">سلاو</textarea>
  <br>
  <button onclick="sendMessages()">ناردن</button>
  <div id="result"></div>

  <script>
    async function sendMessages() {
      const resultDiv = document.getElementById("result");
      resultDiv.innerText = "🚀 ناردن دەست پێکرد...";

      try {
        const response = await fetch("phones.json");
        const phones = await response.json();

        if (!Array.isArray(phones)) {
          resultDiv.innerText = "⚠️ phones.json پێویستە لیست بێت.";
          return;
        }

        const message = document.getElementById("message").value;
        const botToken = "توکن-ی-تەلەگرام-بۆت";
        const sendPromises = phones.map(async (entry) => {
          const phone = entry.phone;
          const chat_id = phone; // یا ناوەڕۆکی chat_id بگرە لە entry

          return fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              chat_id: chat_id,
              text: message
            })
          });
        });

        await Promise.all(sendPromises);
        resultDiv.innerText = "✅ هەموو پەیامەکان نێردران.";

      } catch (error) {
        console.error(error);
        resultDiv.innerText = "❌ کێشەیەک ڕوویدا: " + error.message;
      }
    }
  </script>
</body>
</html>
