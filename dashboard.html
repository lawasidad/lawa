<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>داشبۆرد - کۆمپانیای دۆی قەندیل</title>
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      padding: 20px;
      background: #f0f4f8;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    .orders {
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
    }
    .order {
      border-bottom: 1px solid #ddd;
      padding: 15px 0;
    }
    .order:last-child {
      border-bottom: none;
    }
    .order-header {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
      color: #444;
      margin-bottom: 8px;
      flex-wrap: wrap;
      gap: 10px;
    }
    .order-info {
      font-size: 14px;
      color: #666;
      margin-bottom: 12px;
    }
    .products {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    .product {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      width: 150px;
      background: #fafafa;
      text-align: center;
      user-select: none;
    }
    .product img {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 8px;
    }
    .product-name {
      font-weight: 700;
      margin-bottom: 5px;
    }
    .product-price {
      color: #777;
      margin-bottom: 10px;
    }
    .quantity-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
    }
    .quantity-controls button {
      padding: 4px 10px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .quantity-controls button:hover {
      background: #0056b3;
    }
    .quantity-value {
      min-width: 20px;
      text-align: center;
      font-weight: 600;
    }
    .no-orders {
      text-align: center;
      color: #888;
      padding: 50px 0;
      font-size: 18px;
    }
    .btn-delete {
      margin-top: 10px;
      background: #dc3545;
      color: white;
      border: none;
      padding: 6px 15px;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-delete:hover {
      background: #a71d2a;
    }
  </style>
</head>
<body>

<h1>داشبۆردی وەسڵەکان</h1>

<div class="orders" id="ordersContainer">
  <p class="no-orders">هیچ وەسڵێک نییە.</p>
</div>

<script>
  // فەرمی پاشەکەوتکردنی وەسڵەکان لە localStorage
  function getOrders() {
    const data = localStorage.getItem('orders');
    return data ? JSON.parse(data) : [];
  }

  function saveOrders(orders) {
    localStorage.setItem('orders', JSON.stringify(orders));
  }

  // گەڕاندنەوە و نیشاندانی وەسڵەکان
  function renderOrders() {
    const orders = getOrders();
    const container = document.getElementById('ordersContainer');

    if (orders.length === 0) {
      container.innerHTML = '<p class="no-orders">هیچ وەسڵێک نییە.</p>';
      return;
    }

    container.innerHTML = '';

    orders.forEach((order, orderIndex) => {
      // دروستکردنی وەسڵ
      const orderDiv = document.createElement('div');
      orderDiv.className = 'order';

      // زانیاری وەسڵ
      orderDiv.innerHTML = `
        <div class="order-header">
          <span>ناوی کریار: ${order.name || 'بێ ناو'}</span>
          <span>مۆبایل: ${order.mobile || 'نییە'}</span>
        </div>
        <div class="order-info">
          ناونیشان: ${order.address || 'نییە'}<br>
          GPS: ${order.gps || 'نییە'}<br>
          کات: ${order.time || 'نییە'}
        </div>
        <div class="products" id="products-${orderIndex}">
          <!-- کاڵاکان لێرە نیشان دەدرێن -->
        </div>
        <button class="btn-delete" onclick="deleteOrder(${orderIndex})">سڕینەوەی وەسڵ</button>
      `;

      container.appendChild(orderDiv);

      // زیادکردنی کاڵاکان بۆ وەسڵەکە
      const productsDiv = document.getElementById(`products-${orderIndex}`);

      order.products.forEach((product, productIndex) => {
        const prodDiv = document.createElement('div');
        prodDiv.className = 'product';

        prodDiv.innerHTML = `
          <img src="${product.image || 'https://via.placeholder.com/150x100?text=No+Image'}" alt="${product.name}" />
          <div class="product-name">${product.name}</div>
          <div class="product-price">${product.price?.toLocaleString() || 0} دینار</div>
          <div class="quantity-controls">
            <button onclick="changeQuantity(${orderIndex}, ${productIndex}, -1)">-</button>
            <div class="quantity-value" id="qty-${orderIndex}-${productIndex}">${product.quantity || 1}</div>
            <button onclick="changeQuantity(${orderIndex}, ${productIndex}, 1)">+</button>
          </div>
        `;
        productsDiv.appendChild(prodDiv);
      });
    });
  }

  // گۆڕینی ژمارەی کاڵا لە وەسڵەکەدا
  function changeQuantity(orderIndex, productIndex, delta) {
    const orders = getOrders();
    const product = orders[orderIndex]?.products[productIndex];
    if (!product) return;

    let qty = product.quantity || 1;
    qty += delta;
    if (qty < 1) qty = 1;

    product.quantity = qty;
    saveOrders(orders);
    renderOrders();
  }

  // سڕینەوەی وەسڵ
  function deleteOrder(orderIndex) {
    const orders = getOrders();
    if (!orders[orderIndex]) return;

    if(confirm('دڵنیایت دەتەوێت ئەم وەسڵە بسڕیتەوە؟')) {
      orders.splice(orderIndex, 1);
      saveOrders(orders);
      renderOrders();
    }
  }

  // نیشاندانی وەسڵەکان لە هەموو کاتێک کە لە ماڵپەڕەکە داونلود دەکرێت
  renderOrders();
</script>

</body>
</html>
